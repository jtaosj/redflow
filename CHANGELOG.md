# 更新日志

所有重要的项目更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [2.3.2] - 2025-01-XX

### 新增

- 新增全局视觉指南功能，在大纲生成时定义统一的配色、字体、布局、装饰和整体美学风格
- 新增每页视觉元数据，为每个页面指定具体的视觉特征（主色调、视觉重点、布局模式、装饰风格）

### 改进

- **重大优化：优化大纲生成逻辑，增加结构化约束**
  - 大纲生成时包含全局视觉指南，确保所有页面遵循统一的设计原则
  - 每页包含视觉元数据，为并行图片生成提供明确的视觉约束
  - 解决并行生成时图片风格不一致的问题，每个请求都有明确的视觉指导
  
- **优化配色一致性约束**
  - 强制要求所有内容页使用相同的全局主色调，不允许变体
  - 强制要求总结页与内容页使用完全相同的主色调
  - 封面页可以使用全局主色调或兼容配色，保持整体协调
  - 显著提升帖子的整体完整性和视觉统一性

- 优化风格提示词配置，移除所有技术规格数字（如"2048x2730 pixels"），避免被AI误渲染为图片中的文字内容
- 优化风格提示词描述，将所有英文描述翻译为中文，避免被误识别为图片内容
- 优化图片生成prompt构建逻辑，明确视觉指南优先级顺序（全局视觉指南 > 当前页视觉约束 > 风格要求）

### 修复

- **修复风格提示词注入失败的bug**
  - 修复所有调用`generatePageImage`的地方缺少`style`参数的问题
  - 修复`imageGeneration.ts`中`styleSection`变量作用域问题，确保调试日志准确显示
  
- **修复风格提示词误渲染问题**
  - 修复所有风格提示词中包含的技术规格数字（如"2048x2730"）被误渲染为图片文字的问题
  - 修复风格提示词中英文描述被误识别为图片内容的问题
  - 为所有风格添加明确的约束指令，禁止渲染技术规格信息

- 修复变量作用域问题，`styleSection`变量在所有分支中都能正确访问

## [2.2.0] - 2025-01-XX

### 新增

- 新增提示词生成图片模式，支持批量生成
- 新增风格提示词管理系统，支持自定义每个风格的详细提示词
- 新增风格选择功能（小红书爆款、海报风格、INS极简、科技未来、自然清新）
- 新增图片数量选择功能，可控制生成图片数量（6-12张）

### 改进

- 优化风格传递机制，风格作为元数据传递而非文本内容
- 优化大纲生成逻辑，严格按照用户指定的图片数量生成
- 优化图片生成提示词，使用详细的风格提示词模板
- 优化历史记录存储策略，对所有模式图片进行压缩以节省存储空间
- 改进localStorage存储错误处理，更积极地清理旧数据
- 优化API Key输入体验，采用卡片式输入设计

### 修复

- 修复生成大纲时自动多生成一张的问题
- 修复风格提示词未传递给图片生成工具的问题
- 修复localStorage存储空间不足的错误
- 修复提示词生图历史记录详情显示错误的问题
- 修复API Key输入第一次失败的问题

## [2.1.0] - 2025-01-XX

### 新增

- 添加下载完整文字内容功能（Markdown格式）
- 增强一键下载功能，支持分别下载图片和文字内容
- 优化历史记录保存逻辑，确保文生图完成后正确保存

### 改进

- 优化历史记录保存机制，增加容错处理和自动用户创建
- 改进结果页面，添加独立的文字内容下载按钮
- 增强下载功能，支持自定义文件名（基于项目名称）

### 修复

- 修复文生图完成后历史记录未保存的问题
- 修复结果页面缺少文字内容下载功能的问题
- 修复历史记录保存失败时的错误处理

## [2.0.0] - 2025-01-XX

### 新增

- 整合文本生成图文与图生图两种创作模式
- 支持文本生成图文模式
- 支持图生图模式
- 统一UI组件库
- Docker部署支持（Nginx和Node.js两种方式）
- 历史记录功能
- 系统设置界面
- 单元测试框架

### 改进

- 优化UI视觉设计
- 完善组件库（Button、Card、Input、Modal、Toast、Progress等）
- 增强错误处理
- 优化API调用逻辑
- 改进响应式布局

### 修复

- 修复API调用重复问题
- 修复历史记录保存问题
- 修复图片生成显示问题
- 修复超时处理问题

## [1.0.0] - 2024-XX-XX

### 新增

- 初始版本发布
- 基础功能实现

