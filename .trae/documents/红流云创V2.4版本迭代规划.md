# 红流云创V2.4版本迭代规划（调整版）

## 1. 迭代目标（调整版）

### 1.1 核心目标
实现全自动"风格锁定 + 无字底图 + 自动排版渲染"流水线，解决当前产品存在的风格同质化、排版不可控、一致性差等核心问题，提升生成内容的质量。**自动重试功能暂缓实现，优先保证核心功能完成**。

### 1.2 具体目标（调整后）
- 建立完整的 `AutoPosterPipeline` 核心流水线，实现从风格锁定到最终图片生成的全自动化
- 实现风格一致性机制，通过 `style_pack + seed_master + 后处理` 保证整套图文风格统一
- 解决排版不可控问题，采用"模型不负责中文排版，系统用固定模板渲染"的方案
- 实现QC自动检测基础功能（**暂缓自动重试**）
- 丰富风格选择，解决当前"米黄色审美疲劳"问题
- 优化成本结构，通过底图复用策略降低生成成本

### 1.3 关键指标（调整后）
| 指标类别 | 具体指标 | 目标值 | 测量方式 |
|---------|---------|-------|---------|
| 生成质量 | 风格一致性 | 封面与内页风格匹配度>95% | 人工评估 |
| 生成质量 | 排版准确率 | 文字位置误差<3px | 自动化测试 |
| 生成质量 | 无文字污染率 | >98% | OCR检测 |
| 生成效率 | 单套图文生成时间 | <60s | 系统日志统计 |
| 成本优化 | 底图复用率 | >60% | 系统日志统计 |
| 用户体验 | 风格多样性 | 支持10+种不同风格 | 人工评估 |
| 用户体验 | 生成结果满意度 | >4.5/5 | 用户调研 |

## 2. 核心功能模块优化清单（调整版）

### 2.1 优先实现的核心功能
- **Style Lock 模块**：实现风格锁定机制，生成/内置 style_pack
- **Background Generation 模块**：生成无字背景底图，强制留白
- **Deterministic Render 模块**：用固定模板渲染文字、图标等
- **QC 基础检测模块**：实现文字污染、安全区、清晰度、合规检测（**暂缓自动重试**）
- **风格一致性系统**：seed_master 机制、底图复用策略、变体合成、统一后处理
- **自动排版渲染系统**：模板渲染器、模板库、自动模板选择、fitText 功能、固定栅格系统
- **无字底图生成系统**：Prompt 模板优化、风格锁定、布局约束、主题适配

### 2.2 暂缓实现的功能
- **自动重试机制**：根据失败原因定向修改 prompt 并重试

## 3. 具体实施步骤（调整版）

### 3.1 第一阶段：基础架构搭建（Week 1）

#### 3.1.1 第1-2天：Style Lock 模块开发
- 实现 style_pack 数据结构定义
- 开发 style_pack 生成与管理功能
- 实现 seed_master 机制

#### 3.1.2 第3-4天：Background Generation 模块开发
- 实现无字底图 Prompt 模板
- 开发基于 style_pack 的底图生成功能
- 实现底图强制留白机制

#### 3.1.3 第5-6天：Deterministic Render 模块开发
- 实现 Canvas/SVG 模板渲染器
- 开发 fitText 功能
- 实现固定栅格与固定层级系统

#### 3.1.4 第7天：3个核心模板开发
- 开发封面模板
- 开发 LIST_5 模板
- 开发 STEP_N 模板

### 3.2 第二阶段：核心功能完善（Week 2）

#### 3.2.1 第1-2天：QC 基础检测模块开发（**无自动重试**）
- 实现 OCR 文字污染检测
- 开发可读性安全区检测
- 实现清晰度检测
- 实现合规检测

#### 3.2.2 第3-4天：底图复用与变体合成开发
- 实现底图复用策略
- 开发变体合成功能（裁切、旋转、叠加纹理等）
- 实现统一后处理效果

#### 3.2.3 第5-6天：3套非米黄色 palette 开发
- 开发莫兰迪蓝灰风格 palette
- 开发多巴胺亮色风格 palette
- 开发黑金霓虹风格 palette

#### 3.2.4 第7天：系统集成与初步测试
- 集成已开发模块
- 进行初步测试和问题修复

### 3.3 第三阶段：剩余模板开发与系统优化（Week 3）

#### 3.3.1 第1-2天：剩余模板开发
- 开发 DO_DONT 模板
- 开发 BEFORE_AFTER 模板
- 开发 CARD_3 模板
- 开发 QA_3 模板

#### 3.3.2 第3-4天：自动模板选择算法开发
- 实现基于规则的模板自动选择
- 开发模板适配逻辑
- 实现模板优先级管理

#### 3.3.3 第5-6天：系统优化与测试
- 优化系统性能
- 修复发现的问题
- 进行集成测试

#### 3.3.4 第7天：用户验收测试准备
- 准备测试环境和测试用例
- 邀请种子用户参与测试

### 3.4 第四阶段：全面测试与上线准备（Week 4）

#### 3.4.1 第1-3天：全面测试
- 进行单元测试
- 进行集成测试
- 进行端到端测试
- 进行性能测试

#### 3.4.2 第4-5天：用户验收测试
- 收集用户反馈
- 进行必要的调整和优化

#### 3.4.3 第6-7天：上线准备与发布
- 编写发布文档
- 进行上线前最终检查
- 2.4 版本正式上线

## 4. 资源分配方案（调整版）

### 4.1 团队角色与职责（调整后）

| 角色 | 职责 | 人数 | 调整说明 |
|-----|-----|-----|---------|
| 产品经理 | 需求分析、产品设计、测试用例设计、用户验收测试 | 1 | 无变化 |
| 前端开发 | 模板渲染器开发、Canvas/SVG 渲染、UI 集成 | 2 | 无变化 |
| 后端开发 | AutoPosterPipeline 核心逻辑、API 开发、QC 模块 | 2 | 减少自动重试相关开发工作 |
| AI 算法工程师 | Prompt 优化、风格生成算法 | 1 | 减少自动重试相关算法开发 |
| 测试工程师 | 单元测试、集成测试、端到端测试、性能测试 | 1 | 减少自动重试相关测试用例 |
| 设计师 | style_pack 设计、模板设计、色彩方案设计 | 1 | 无变化 |

### 4.2 资源需求（调整后）

| 资源类型 | 需求 | 调整说明 |
|---------|-----|---------|
| 计算资源 | 开发服务器、测试服务器 | 无变化 |
| AI API 调用 | Google GenAI API 调用额度 | 需求减少（无自动重试） |
| OCR 服务 | 文字检测 OCR 服务 | 无变化 |
| 测试设备 | 多种浏览器测试环境 | 无变化 |

## 5. 时间节点安排（调整版）

| 阶段 | 时间周期 | 关键里程碑 | 调整说明 |
|-----|---------|-----------|---------|
| 第一阶段：基础架构搭建 | Week 1 | style_pack 机制、无字底图生成、渲染器、3个核心模板 | 无变化 |
| 第二阶段：核心功能完善 | Week 2 | QC 基础检测、底图复用、3套非米黄色 palette | 移除自动重试开发 |
| 第三阶段：剩余模板开发与系统优化 | Week 3 | 所有模板开发完成、AutoPosterPipeline 集成测试通过 | 增加系统优化时间 |
| 第四阶段：全面测试与上线准备 | Week 4 | 全面测试通过、用户验收测试通过、发布准备完成 | 增加用户验收测试时间 |
| 正式发布 | Week 4 结束 | 2.4 版本正式上线 | 无变化 |

## 6. 质量验收标准（调整版）

### 6.1 功能验收标准（调整后）

| 功能模块 | 验收标准 | 调整说明 |
|---------|---------|---------|
| Style Lock | 能成功生成/加载 style_pack，包含完整的风格参数 | 无变化 |
| Background Generation | 生成的底图无文字，包含指定的留白区域，符合 style_pack 风格 | 无变化 |
| Deterministic Render | 能准确渲染文字、图标等元素，fitText 功能正常工作 | 无变化 |
| QC 基础检测 | 能准确检测文字污染、安全区问题、模糊图像和违规内容 | **移除自动重试验收** |
| 底图复用 | 能成功复用底图并生成变体，变体效果符合预期 | 无变化 |
| 模板自动选择 | 能根据内容自动选择合适的模板，选择准确率>90% | 无变化 |
| 风格一致性 | 整套图文风格一致，匹配度>95% | 无变化 |

### 6.2 性能验收标准（调整后）

| 性能指标 | 验收标准 | 调整说明 |
|---------|---------|---------|
| 单张图片生成时间 | <20s | 无变化 |
| 单套图文生成时间 | <60s | 无变化 |
| 系统稳定性 | 连续运行24小时无崩溃 | 无变化 |

### 6.3 兼容性验收标准（调整后）

| 兼容项 | 验收标准 | 调整说明 |
|-------|---------|---------|
| 浏览器兼容 | 支持 Chrome、Firefox、Safari、Edge 最新版本 | 无变化 |
| 设备兼容 | 支持桌面端和移动端访问 | 无变化 |
| 分辨率兼容 | 生成的图片在不同分辨率下显示正常 | 无变化 |

## 7. 风险评估与应对策略（调整版）

| 风险类别 | 具体风险 | 影响程度 | 发生概率 | 应对方案 | 调整说明 |
|---------|---------|---------|---------|---------|---------|
| 技术风险 | OCR 文字检测准确率不足 | 中 | 中 | 1. 选择可靠的 OCR 服务<br>2. 优化 OCR 检测逻辑<br>3. 增加人工复核机制 | 无变化 |
| 技术风险 | 自动模板选择准确率不足 | 中 | 中 | 1. 优化模板选择规则<br>2. 增加模板优先级机制<br>3. 预留手动模板切换入口 | 无变化 |
| 性能风险 | 系统生成速度慢 | 高 | 中 | 1. 优化 API 调用逻辑<br>2. 实现异步生成<br>3. 优化底图生成参数 | 无变化 |
| 成本风险 | AI API 调用成本过高 | 低 | 低 | 1. 优化底图复用策略<br>2. 实现生成结果缓存 | **风险降低（无自动重试）** |
| 质量风险 | 生成的底图不符合预期 | 中 | 中 | 1. 优化 Prompt 模板<br>2. 增加底图候选数量<br>3. 实现人工干预机制 | 无变化 |
| 资源风险 | 开发资源不足 | 低 | 低 | 1. 优先保证核心功能开发<br>2. 调整开发计划 | **风险降低（减少自动重试开发）** |

## 8. 版本迭代后续规划（调整版）

### 8.1 2.4版本迭代交付物（调整后）
- AutoPosterPipeline 核心流水线（**无自动重试**）
- 6种内容页模板
- 3套非米黄色 palette
- QC 基础检测功能（**无自动重试**）
- 底图复用与变体合成功能

### 8.2 2.4.1版本规划（小版本迭代，后续实现）
- 实现自动重试机制
- 优化 QC 检测逻辑
- 增加更多风格选项

### 8.3 2.5版本规划方向
- 实现更高级的分层渲染效果
- 支持用户自定义 style_pack
- 实现 AI 辅助的排版优化建议

## 9. 结论

根据用户反馈，红流云创V2.4版本迭代规划已调整为**暂缓实现自动重试功能**，优先保证核心功能完成。调整后的规划仍然聚焦于解决用户反馈的三大核心问题：视觉同质化、排版不可控和风格一致性。

通过建立完整的 `AutoPosterPipeline` 核心流水线，实现风格锁定、无字底图生成、自动排版渲染和QC基础检测功能，我们将从根本上解决这些问题，提升产品质量和用户满意度。同时，底图复用策略将有效降低生成成本，3套非米黄色 palette 将解决当前的"米黄色审美疲劳"问题。

调整后的规划更加聚焦于核心功能，资源分配更加合理，风险更低，能够确保2.4版本按时高质量交付。自动重试功能将在后续版本中实现，以进一步提升生成成功率和用户体验。